# Игровой движок <!-- omit in toc -->

- [Settings](#Settings)
- [SettingsClassic](#SettingsClassic)
- [GameEngine](#GameEngine)
- [Board](#Board)
- [Figure](#Figure)
- [Конкретные фигуры](#Конкретные-фигуры)
- - [King](#King)
- - [Queen](#Queen)
- - [Rook](#Rook)
- - [Knight](#Knight)
- - [Bishop](#Bishop)
- - [PawnPawn](#PawnPawn)
- [Player](#Player)
- [Move](#Move)
- [Notation](#Notation)
- [Sound](#Sound)
  
## Settings
Абстрактный класс хранящий в себе настройки

|           Имя           | Описание                                                                                              |
|:-----------------------:|:------------------------------------------------------------------------------------------------------|
|         **ctx**         | 2D контекст рисования, используемый для визуализации игры на экране.                                  |
|        **debug**        | Флаг, указывающий, включен ли режим отладки (по умолчанию: `false`).                                  |
|        **width**        | Ширина игрового поля (количество клеток по горизонтали).                                              |
|       **height**        | Высота игрового поля (количество клеток по вертикали).                                                |
|      **gameMode**       | Режим игры (например, игра против компьютера, игра для двух игроков на одном или разных устройствах). |
|        **type**         | Тип шахмат (например, классические шахматы, шахматы Фишера и т.д.).                                   |
|      **withTime**       | Указывает, происходит ли игра с таймером или без.                                                     |
|   **minutesPerParty**   | Количество минут, отведенное на партию (от 1 до 60).                                                  |
| **countSecondsPerMove** | Количество добавляемых секунд на ход (от 0 до 120).                                                   |
|        **start**        | Callback, вызываемый при начале игры.                                                                 |
|        **stop**         | Callback, вызываемый при остановке игры.                                                              |
|      **gameLoop**       | Callback, вызываемый в каждом проходе игрового цикла.                                                 |
|     **onGameOver**      | Callback, вызываемый при окончании игры.                                                              |
## SettingsClassic
Классические настройки для шахмат, наследуется от Settings
Расширяет следующими методами

|        Имя         | Описание                                  |
|:------------------:|:------------------------------------------|
|  **getContext()**  | возвращает 2D контекст рисования          |
| **isDebugMode()**  | возвращает значение включен дебаг или нет |
| **getBoardSize()** | возвращает размер доски (w, h)            |
| **getGameMode()**  | возвращает строковое значение,            |

[//]: # (## FischerRandomChessSettings)
[//]: # (Шахматы фишера&#40;с рандомной расстановкой&#41;)
## GameEngine
Основной класс, здесь запускается игровой цикл, здесь запускается инициализация всех игровых объектов. А также содержатся вспомогательные методы по работе с различной логикой игры.
Аргументы конструктора тип `TGameEngineOptions`

|          Имя          | Описание                                                                                                               |
|:---------------------:|:-----------------------------------------------------------------------------------------------------------------------|
|  **init(settings)**   | Метод для инициализации игрового движка с использованием переданных настроек из класса `Settings`.                     |
|      **start()**      | Запускает игровой процесс, инициализируя необходимые объекты и вхождение в игровой цикл.                               |
|      **stop()**       | Останавливает игровой процесс, освобождая ресурсы и завершает текущую игру.                                            |
|    **gameLoop()**     | Основной метод игрового цикла, который вызывается на каждом кадре для обновления состояния игры и отрисовки элементов. |
| **updateGameLogic()** | Обновляет логику игры: перемещение фигур, проверка условий победы и т.д.                                               |
|    **drawGame()**     | Обрабатывает визуализацию всех игровых объектов на экране, используя контекст рисования.                               |
|   **handleInput()**   | Обрабатывает пользовательский ввод, например щелчки мыши или нажатия клавиш, для управления игровыми фигурами.         |
|  **checkGameOver()**  | Проверяет, завершена ли игра (например, мат или ничья), и вызывает соответствующие действия.                           |
|   **restartGame()**   | Перезапускает игру, сбрасывая все параметры и заново инициализируя игровое поле.                                       |

## Board
Представляет шахматную доску и отвечает за отображение фигур и их расположение на ней

|              Имя              | Описание                                                                     |
|:-----------------------------:|:-----------------------------------------------------------------------------|
|           **init**            | инициализирует шахматную доску с фигурами в начальном положении              |
|          **display**          | отображает текущее состояние доски                                           |
|      **getFigure(x, y)**      | возвращает фигуру, находящейся на позиции x y                                |
|        **resetBoard**         | сбрасывает доску к начальному состоянию                                      |
|      **getFigure(x, y)**      | возвращает список всех допустимых ходов для данной фигуры из текущей позиции |
| **isValidMove(figure, x, y)** | проверяет, является ли предложенный ход легитимным для данной фигуры         |

## Figure
Абстрактный класс для шахматных фигур, включая общие атрибуты и методы, 
такие как движение и законность хода.

|    Имя     | Описание                                                                                                                                                                                             |
|:----------:|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  **init**  | должен содержать в себе всю асинхронную логику инициализации игрового объекта, в случае успешной инициализации возвращать true иначе false                                                           |
| **update** | должен обновлять состояние игрового объекта вызывается в начале расчета кадра отрисовки, на вход получает время прошедшее с прошлого кадра. Должен содержать всю игровую логику (перемещение и т.д.) |
|  **draw**  | отрисовка игрового объекта, должен содержать всю логику работы с canvas                                                                                                                              |

# Конкретные фигуры
## King
|  Имя   | Описание                                                   |
|:------:|:-----------------------------------------------------------|
|  init  | Инициализация королевской фигуры.                          |
| update | Проверка допустимости ходов для короля, включая рокировку. |
|  draw  | Отрисовка короля на доске.                                 |
## Queen
|  Имя   | Описание                               |
|:------:|:---------------------------------------|
|  init  | Инициализация ферзя.                   |
| update | Проверка допустимости ходов для ферзя. |
|  draw  | Отрисовка ферзя на доске.              |
## Rook
|  Имя   | Описание                               |
|:------:|:---------------------------------------|
|  init  | Инициализация ладьи.                   |
| update | Проверка допустимости ходов для ладьи. |
|  draw  | Отрисовка ладьи на доске.              |
## Knight
|  Имя   | Описание                              |
|:------:|:--------------------------------------|
|  init  | Инициализация коня.                   |
| update | Проверка допустимости ходов для коня. |
|  draw  | Отрисовка коня на доске.              |
## Bishop
|  Имя   | Описание                               |
|:------:|:---------------------------------------|
|  init  | Инициализация слона.                   |
| update | Проверка допустимости ходов для слона. |
|  draw  | Отрисовка слона на доске.              |
## Pawn
|  Имя   | Описание                                                    |
|:------:|:------------------------------------------------------------|
|  init  | Инициализация пешки.                                        |
| update | Проверка допустимости ходов для пешки, включая превращение. |
|  draw  | Отрисовка пешки на доске.                                   |

# Player
Включает информацию о его цвете фигур и возможных действиях

|             Имя              | Описание                                                                  |
|:----------------------------:|:--------------------------------------------------------------------------|
|      init(name, color)       | Инициализация игрока, устанавливает имя и цвет фигур.                     |
| makeMove(start_pos, end_pos) | Инициирует движение фигуры и взаимодействует с классами `Move` и `Board`. |
|            isTurn            | Проверяет, настало ли время данного игрока делать ход.                    |
|           endTurn            | Завершает текущий ход игрока.                                             |
|   getAvailableMoves(board)   | Возвращает список доступных ходов для всех фигур игрока на данной доске.  |

# Move
Описывает перемещение фигур, включая начальную и конечную позиции
и проверяет легитимность хода

| Имя                                    | Описание                                                                      |
|:---------------------------------------|:------------------------------------------------------------------------------|
| init(piece, startX,startY, endX, endY) | Инициализация перемещения, включая выбранную фигуру и позиции.                |
| isLegalMove(board)                     | Проверяет, легален ли ход на основе текущего состояния доски и правил фигуры. |
| execute(board)                         | Выполняет перемещение фигуры на доске.                                        |
| undo(board)                            | Отменяет перемещение фигуры, восстанавливая предыдущее состояние.             |
| getMoveNotation                        | Возвращает строковое представление хода в шахматной нотации.                  |
# Notation

| Имя                        | Описание                                                               |
|:---------------------------|:-----------------------------------------------------------------------|
| toAlgebraic(move)          | Преобразует движение в алгебраическую нотацию (например, `e4`, `Nf3`). |
| fromAlgebraic(notation)    | Преобразует строку нотации обратно в объект `Move`.                    |
| getHistory(moves)          | Возвращает историю ходов в читабельном формате.                        |
| validateNotation(notation) | Проверяет, соответствует ли строка нотации правилам шахмат.            |
# Sound
| Имя                  | Описание                                              |
|:---------------------|:------------------------------------------------------|
| init(sound_file)     | Инициализация звукового объекта с пути к файлу звука. |
| play_move_sound()    | Воспроизводит звук при выполнении хода.               |
| play_capture_sound() | Воспроизводит звук при взятии фигуры.                 |
| play_check_sound()   | Воспроизводит звук, когда king находится под угрозой. |
| mute()               | Отключает все звуки.                                  |
| set_volume(level)    | Устанавливает уровень громкости.                      |

